# 问题

为了解决移动游戏全球发行时的语言翻译问题，需要在游戏中设计并实现多语言系统。

# 核心思路

字符串本质上是一种游戏资产。对于表达相同含义的不同语言的多个字符串，可以使用同一个ID来进行索引。游戏代码逻辑中，使用ID对字符串资源进行引用。多语言系统根据当前版本的语言设置，将字符串ID解析为不同语言对应的字符串资源，实现游戏在多种语言之间的切换。

# 语言资产种类

按照语言资产的载体不同，大致可以将其分为两类

* 文字字符串资产，即使用字体进行渲染的文字信息
* 带有文字的图片资产，即使用图片进行渲染的文字信息

# 字符串表

文字字符串资产配置在Excel表格中。字符串表中，全局唯一的字符串ID和字符串内容是必须配置的数据。此外，还可以加入备注来标记字符串的用途、语境等信息。在实践中，需要按照游戏的功能模块对文字字符串进行分类，配置在独立的表格中。这样做的好处有三，一是方便日后策划并行编辑字符串资源，二是降低每次版本更新时变动的字符串资产文件大小，三是方便进行文字翻译的外包工作。

# 文字图片

游戏的UI设计中会遇到用更好的视觉效果来展示信息的情况，普通的字体渲染文字满足不了这种需求，这时候就会用到文字图片。游戏中增加多语言资产目录，每个多语言资产目录下的结构保持一致。不同语言对应的表达相同信息的图片资产，其文件名保持一致，分别存放在这些多语言资产目录下。

# 当前语言设置

游戏程序中增加当前语言设置的概念。根据当前语言设置的不同，分别加载对应语言的字符串表，调整多语言图片资产加载的目录，以实现多语言的切换功能。
多语言设置在设计时要遵循对其他游戏系统透明的原则，在实现其他游戏系统的逻辑时不需要关心当前是何种语言设置。在使用到字符串资产的地方，以字符串资产ID为参数调用语言翻译接口，自动根据当前语言设置获取最终使用的字符串。文字图片资产的加载亦是如此，资产加载接口底层会根据当前语言设置调整资产目录的加载顺序，确保加载到当前语言对应的文字图片。

# 翻译工具链

游戏文本的翻译工作需要由专业的语言翻译工作者来进行，所以要把这部分工作外包给专业的翻译公司。字符串表是进行语言翻译工作的载体，原始的中文字符串表由工作室交付给翻译公司，翻译工作完成后再由翻译公司交付翻译好的外文字符串表给工作室，转换为游戏中可用的资产。
围绕字符串表会形成一套固定的工作流程，可以总结为三个部分：

* 由总字符串表生成需要翻译的表。这个过程需要排除已经翻译的部分，将新增的部分存入表中
* 将从翻译公司返回的翻译表（每种语言对应一个）合并为总字符串表
* 将总字符串表生成游戏可用的字符串资产。可以使用json格式文件

流程中需要制作工具进行支持，建议使用python进行工具的制作，因为其对Excel表格的读写有现成的库（xlrd，xlsxwriter）支持，而且可以支持跨平台（Windows，Mac等）